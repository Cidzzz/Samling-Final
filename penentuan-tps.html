<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samling | Pantau TPS</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: DM Sans -->
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Icons: FontAwesome -->
    <script src="https://kit.fontawesome.com/59135e8829.js" crossorigin="anonymous"></script>

    <!-- Chart.js untuk Grafik -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="javascript/theme-loader.js"></script>
    <link rel="stylesheet" href="css/themes.css">

    <style>
        body {
            font-family: 'DM Sans', sans-serif;
            background-color: #F9FAFB;
        }
        /* Animasi Modal */
        .modal-enter {
            opacity: 0;
            transform: scale(0.95);
        }
        .modal-enter-active {
            opacity: 1;
            transform: scale(1);
            transition: opacity 300ms, transform 300ms;
        }
        .modal-exit {
            opacity: 1;
            transform: scale(1);
        }
        .modal-exit-active {
            opacity: 0;
            transform: scale(0.95);
            transition: opacity 200ms, transform 200ms;
        }
        
        /* Style khusus untuk Circular Progress di Modal */
        .circular-chart {
            display: block;
            margin: 0 auto;
            max-width: 100%;
            max-height: 250px;
        }
        .circle-bg {
            fill: none;
            stroke: #eee;
            stroke-width: 3.8;
        }
        .circle {
            fill: none;
            stroke-width: 2.8;
            stroke-linecap: round;
            animation: progress 1s ease-out forwards;
        }
        @keyframes progress {
            0% { stroke-dasharray: 0 100; }
        }
        .percentage {
            fill: #111;
            font-family: 'DM Sans', sans-serif;
            font-weight: bold;
            font-size: 0.5em;
            text-anchor: middle;
        }
        .label {
            fill: #666;
            font-family: 'DM Sans', sans-serif;
            font-size: 0.15em;
            text-anchor: middle;
        }
    </style>
</head>
<body>
    <a href="beranda.html" class="absolute top-4 left-4 bg-green-500 text-white p-2 rounded-full hover:bg-green-600 transition-colors z-20">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
    </a>

    <!-- Header / Navbar Samling -->
    <nav class="bg-white border-b border-gray-200 px-8 py-4 mb-8 shadow-sm sticky top-0 z-10">
        <div class="max-w-7xl mx-auto flex items-center gap-3">
            <div class="w-10 h-10 bg-green-50 rounded-full flex items-center justify-center">
                <i class="fa-solid fa-leaf text-green-600 text-xl"></i>
            </div>
            <h1 class="text-2xl font-bold text-green-700 tracking-tight">Samling</h1>
        </div>
    </nav>

    <!-- Konten Utama -->
    <div class="max-w-7xl mx-auto px-8 pb-12">
        <div class="mb-6">
            <h2 class="text-lg font-bold text-black">Pantau TPS</h2>
        </div>

        <div class="bg-white border border-gray-200 rounded-xl p-8 shadow-sm min-h-[500px]">
            <div id="tps-list-container" class="flex flex-col gap-8">
                <!-- Item TPS -->
            </div>
        </div>
    </div>

    <!-- MODAL DETAIL (Hidden by default) -->
    <div id="detail-modal" class="fixed inset-0 z-50 hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <!-- Backdrop -->
        <div class="fixed inset-0 bg-gray-900 bg-opacity-50 transition-opacity" onclick="closeModal()"></div>

        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>

            <!-- Modal Panel -->
            <div class="relative inline-block align-bottom bg-white rounded-2xl text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full">
                
                <!-- Header Modal -->
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 border-b border-gray-100">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-4">
                            <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                                <i class="fa-solid fa-arrow-left text-xl"></i>
                            </button>
                            <div>
                                <h3 class="text-xl font-bold text-gray-900" id="modal-tps-name">TPS Name</h3>
                                <p class="text-sm text-gray-500 " id="modal-tps-location"><i class="fa-solid fa-location-dot mr-1"></i> Location</p>
                            </div>
                        </div>
                        
                        <!-- LOGO SAMLING (DAUN) DI HEADER MODAL -->
                        <div class="w-10 h-10 bg-green-50 rounded-full flex items-center justify-center">
                            <i class="fa-solid fa-leaf text-green-600 text-xl"></i>
                        </div>
                    </div>
                </div>

                <!-- Isi Modal -->
                <div class="px-4 pt-5 pb-4 sm:p-6 bg-gray-50 overflow-y-scroll h-[78vh]">
                    
                    <!-- Grid Statistik Atas -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                        
                        <!-- Card Kapasitas (Circular) -->
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col items-center justify-center col-span-1 md:col-span-1 relative overflow-hidden">
                            <h4 class="text-sm font-semibold text-gray-500 mb-4 w-full text-left">Status Saat Ini</h4>
                            
                            <!-- SVG Circular Progress -->
                            <svg viewBox="0 0 36 36" class="circular-chart text-green-500 w-40 h-40">
                                <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                <path id="circle-progress" class="circle" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                <text x="18" y="20.35" class="percentage" id="modal-percentage">0%</text>
                                <text x="18" y="25" class="label">Kapasitas</text>
                            </svg>
                        </div>

                        <!-- Card Info Sensor & Kategori -->
                        <div class="col-span-1 md:col-span-2 flex flex-col gap-6">
                            
                            <!-- Sensor & Update Info -->
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center">
                                <div>
                                    <p class="text-sm text-gray-500  mb-1">Kesehatan Sensor</p>
                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">
                                        <span class="w-2 h-2 bg-green-600 rounded-full mr-2"></span> Bagus
                                    </span>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm text-gray-500  mb-1">Terakhir Diupdate</p>
                                    <p class="font-semibold text-gray-900">5 menit lalu</p>
                                </div>
                            </div>

                            <!-- Kategori Sampah -->
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex-1">
                                <p class="text-sm text-gray-500 mb-3">Kategori Sampah</p>
                                <div class="flex items-center gap-3">
                                    <div class="p-3 bg-green-50 rounded-lg text-green-600">
                                        <i class="fa-solid fa-recycle text-xl"></i>
                                    </div>
                                    <div>
                                        <h5 class="font-bold text-gray-900" id="modal-tps-jenis">Jenis Sampah</h5>
                                        <p class="text-xs text-gray-400">Terdeteksi otomatis oleh sensor AI</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                
                <main class="flex flex-col w-full gap-8 mb-6">
                <main class="flex flex-row justify-between items-center gap-8 w-full">
                    <main class="kapasitas-penampungan bg-white flex flex-col gap-2 justify-center items-start shadow-sm p-6 w-[50%] rounded-lg">
                    <main class="flex flex-row justify-center items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <path fill="#6a7282 " d="M21.92 6.62a1 1 0 0 0-.54-.54A1 1 0 0 0 21 6h-5a1 1 0 0 0 0 2h2.59L13 13.59l-3.29-3.3a1 1 0 0 0-1.42 0l-6 6a1 1 0 0 0 0 1.42a1 1 0 0 0 1.42 0L9 12.41l3.29 3.3a1 1 0 0 0 1.42 0L20 9.41V12a1 1 0 0 0 2 0V7a1 1 0 0 0-.08-.38" />
                        </svg>
                        <h4 class="text-gray-500 text-sm">Kapasitas Penampungan Saat Ini</h4>
                    </main>
                    <main class="persentase-kapasitas">
                        <h1 class="persentase text-2xl font-semibold">67%</h1>
                    </main>
                </main>
                <main class="berat-penampungan bg-white flex flex-col gap-2 justify-center items-start shadow-sm p-6 w-[50%] rounded-lg">
                    <main class="flex flex-row justify-center items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48">
            <g fill="none">
                <path stroke="#6a7282 " stroke-linejoin="round" stroke-width="4" d="M41 4H7a3 3 0 0 0-3 3v34a3 3 0 0 0 3 3h34a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3Z" />
                <path stroke="#6a7282 " stroke-linecap="round" stroke-width="4" d="M12 19.054q4.987-6 12-6q7.012 0 12 6" />
                <path fill="#6a7282 " d="M24 31a3 3 0 1 0 0-6a3 3 0 0 0 0 6" />
                <path stroke="#6a7282 " stroke-linecap="round" stroke-width="4" d="m19 21l5.008 7" />
            </g>
        </svg>
                        <h4 class="text-gray-500 text-sm">Berat Penampungan</h4>
                    </main>
                    <main class="persentase-berat">
                        <h1 class="persentase text-2xl font-semibold">2340 Kg</h1>
                    </main>
                </main>
                <!---->
                </main>
                <main class="grid grid-cols-3 place-items-center gap-8">
                    <main class="aktivitas-pegawai bg-white flex flex-col gap-2 justify-center items-start shadow-sm p-6 w-full rounded-lg">
                    <main class="flex flex-row justify-center items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <path fill="none" stroke="#6a7282 " stroke-width="2" d="M12 13a4 4 0 1 0 0-8a4 4 0 0 0 0 8Zm-6 9v-3a6 6 0 1 1 12 0v3M13 5c.404-1.664 2.015-3 4-3c2.172 0 3.98 1.79 4 4c-.02 2.21-1.828 4-4 4h-1h1c3.288 0 6 2.686 6 6v2M11 5c-.404-1.664-2.015-3-4-3c-2.172 0-3.98 1.79-4 4c.02 2.21 1.828 4 4 4h1h-1c-3.288 0-6 2.686-6 6v2" />
                        </svg>
                        <h4 class="text-gray-500 text-sm">Aktivitas Pegawai</h4>
                    </main>
                    <main class="persentase-pegawai">
                        <h1 class="persentase text-2xl font-semibold">5 Orang</h1>
                    </main>
                </main>
                <main class="berat-penampungan bg-white flex flex-col gap-2 justify-center items-start shadow-sm p-6 w-full rounded-lg">
                    <main class="flex flex-row justify-center items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <path fill="#6a7282 " d="M12.5 23q-.625 0-1.062-.425T11 21.525q0-.3.113-.575t.337-.475l1.05-.975l1.05.975q.225.2.338.475t.112.575q0 .625-.437 1.05T12.5 23m-3.45-1.5L8 20.45l2.95-2.95L12 18.55zM15.5 20L14 18.5l1.5-1.5l1.5 1.5zm-9 0L5 18.5L6.5 17L8 18.5zm1-4q-2.275 0-3.887-1.612T2 10.5q0-2.075 1.375-3.625t3.4-1.825q.8-1.425 2.188-2.238T12 2q2.25 0 3.913 1.438t2.012 3.587q1.725.15 2.9 1.425T22 11.5q0 1.875-1.312 3.188T17.5 16zm0-2h10q1.05 0 1.775-.725T20 11.5t-.725-1.775T17.5 9H16V8q0-1.65-1.175-2.825T12 4q-1.2 0-2.187.65T8.325 6.4l-.25.6H7.45q-1.425.05-2.437 1.063T4 10.5q0 1.45 1.025 2.475T7.5 14M12 9" />
        </svg>
                        <h4 class="text-gray-500 text-sm">Suhu Cuaca</h4>
                    </main>
                    <main class="persentase-cuaca bg-white">
                        <h1 class="persentase text-2xl font-semibold">34Â°</h1>
                    </main>
                </main>
                <main class="gas bg-white flex flex-col gap-2 justify-center items-start shadow-sm p-6 w-full rounded-lg">
                    <main class="flex flex-row justify-center items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48">
                        <g fill="none" stroke="#6a7282 " stroke-width="4">
                            <path stroke-linejoin="round" d="M23.049 9.789c1.626-.436 3.291.508 3.72 2.109s-.541 3.25-2.167 3.686S6.708 17 6.708 17s14.715-6.776 16.34-7.211Zm.058 28.658c1.625.435 3.291-.509 3.72-2.11s-.542-3.25-2.168-3.686c-1.625-.436-17.893-1.647-17.893-1.647s14.715 7.007 16.34 7.443Z" />
                            <path stroke-linecap="round" d="M34 16.004a5 5 0 1 1 4 8H16" />
                        </g>
                    </svg>
                        <h4 class="text-black">Gas</h4>
                    </main>
                    <main class="persentase-gas">
                        <h1 class="persentase text-2xl font-semibold">56%</h1>
                    </main>
                </main>
                </main>
            </main>

            <section class="rincian-pemilahan-sampah bg-white flex flex-col justify-center items-start gap-8 w-full mx-auto p-8 rounded-xl shadow-sm mb-6">
        <main class="title-box"><h2 class=" text-gray-500 text-sm font-semibold">Rincian Pemilahan Sampah</h2></main>
    <main class="flex flex-row justify-around w-full">
        <div class="flex flex-col items-center justify-center">
        <div class="relative w-48 h-48">
        <svg class="w-full h-full transform -rotate-90">
            <circle
                cx="96" cy="96" r="80"
                stroke="#1e293b"
                stroke-width="18"
                fill="none"
            ></circle>

            <circle
                class="organic-progress"
                cx="96" cy="96" r="80"
                stroke="#b3ff4a"
                stroke-width="18"
                fill="none"
                stroke-linecap="round"
            ></circle>
        </svg>

        <div class="absolute inset-0 flex items-center justify-center text-black font-semibold text-3xl">
            58%
        </div>
    </div>
        <!-- Label bawah -->
        <p class="mt-4 text-green-300 text-xl">Organik</p>
        <p class="text-gray-400">1200 kg</p>
    </div>
    <div class="flex flex-col items-center justify-center">
        <div class="relative w-48 h-48">
        <svg class="w-full h-full transform -rotate-90">
            <circle
                cx="96" cy="96" r="80"
                stroke="#1e293b"
                stroke-width="18"
                fill="none"
            ></circle>

            <circle
                class="nonorganic-progress"
                cx="96" cy="96" r="80"
                stroke="#b3ff4a"
                stroke-width="18"
                fill="none"
                stroke-linecap="round"
            ></circle>
        </svg>

        <div class="absolute inset-0 flex items-center justify-center text-black font-semibold text-3xl">
            78%
        </div>
    </div>
        <!-- Label bawah -->
        <p class="mt-4 text-green-300 text-xl">Non-Organik</p>
        <p class="text-gray-400">1357 kg</p>
    </div>
    </main>
    </section>
                    <!-- Chart Trend -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 mb-6">
                        <div class="flex justify-between items-center mb-4">
                            <h4 class="text-sm font-semibold text-gray-500 ">Tren Kapasitas (7 Hari Terakhir)</h4>
                            <i class="fa-solid fa-chart-line text-gray-400"></i>
                        </div>
                        <div class="h-64 w-full">
                            <canvas id="trendChart"></canvas>
                        </div>
                    </div>

                    <!-- Action Buttons Modal -->
                    <div class="grid grid-cols-1 gap-3">
                        <button onclick="requestPickup()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition-colors shadow-sm flex justify-center items-center gap-2">
                            <i class="fa-solid fa-truck"></i> Request Penjemputan
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </div>
    
    <script src="javascript/tps.js"></script>
    <script src="javascript/global.js"></script>
    <script src="javascript/theme.js"></script>
</body>
</html>